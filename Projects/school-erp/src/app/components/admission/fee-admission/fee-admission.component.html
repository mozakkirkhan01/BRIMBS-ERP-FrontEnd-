<app-progress *ngIf="dataLoading"></app-progress>
<main  class="main" *ngIf="action.ResponseReceived">

    <div class="pagetitle">
        <h1>{{action.MenuTitle}}</h1>
        <nav>
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a routerLink="admin/admin-dashboard">Home</a></li>
            <li class="breadcrumb-item">{{action.ParentMenuTitle}}</li>
            <li class="breadcrumb-item active">{{action.MenuTitle}}</li>
          </ol>
        </nav>
      </div>

    <section class="section dashboard">
        <div class="card">
            <div class="card-body mt-3">
                <form #formFeeAdmission="ngForm">
                    <div class="container">
                        <div class="row mt-2">
                            <mat-form-field appearance="outline" class="col-sm-2 form-group">
                                <mat-label>Class</mat-label>
                                <mat-select #ClassId="ngModel" name="ClassId" [(ngModel)]="FeeAdmission.ClassId"
                                    required>
                                    <mat-option [value]="class.ClassId"
                                        *ngFor="let class of ClassList">{{class.ClassName}}</mat-option>
                                </mat-select>
                                <mat-error>
                                    Class is <strong>required</strong>
                                </mat-error>
                            </mat-form-field>

                            <mat-form-field appearance="outline" class="col-sm-2 form-group">
                                <mat-label>Session</mat-label>
                                <mat-select #SessionId="ngModel" name="SessionId" [(ngModel)]="FeeAdmission.SessionId"
                                    required>
                                    <mat-option [value]="session.SessionId"
                                        *ngFor="let session of SessionList">{{session.SessionName}}</mat-option>
                                </mat-select>
                                <mat-error>
                                    Session is <strong>required</strong>
                                </mat-error>
                            </mat-form-field>

                            <mat-form-field appearance="outline" class="col-sm-2  form-group">
                                <mat-label>Pupli Type</mat-label>
                                <mat-select #PupilTypeId="ngModel" name="PupilTypeId"
                                    [(ngModel)]="FeeAdmission.PupilTypeId" required>
                                    <mat-option [value]="pupil.PupilTypeId"
                                        *ngFor="let pupil of PupilTypeList">{{pupil.PupilTypeName}}</mat-option>
                                </mat-select>
                                <mat-error>
                                    Pupil Type is <strong>required</strong>
                                </mat-error>
                            </mat-form-field>

                            <mat-form-field appearance="outline" class="col-sm-3  form-group">
                                <mat-label>Admission Type</mat-label>
                                <mat-select #AdmissionType="ngModel" name="AdmissionType"
                                    [(ngModel)]="FeeAdmission.AdmissionType" required>
                                    <mat-option [value]="AdmissionType.Key"
                                        *ngFor="let AdmissionType of AdmissionTypeList">{{AdmissionType.Value}}</mat-option>
                                </mat-select>
                                <mat-error>
                                    AdmissionType is <strong>required</strong>
                                </mat-error>
                            </mat-form-field>

                            <div class="col-sm-2">
                                <button mat-raised-button color="primary"
                                    (click)="getFeeAdmissionList()">Search</button>
                            </div>
                        </div>
                    </div>
                </form>

                <div class="container" *ngIf="FeeAdmissionList.length>0">
                    <mat-divider class="mb-3"></mat-divider>
                    <div class="table-reponsive">
                        <table class="table table-bordered table-hover">
                            <thead>
                                <tr>
                                    <th>S.No</th>
                                    <th (click)="sort('HeadName')">Head</th>
                                    <th (click)="sort('FeeAmount')">Amount</th>
                                    <th (click)="sort('IsActive')">Active</th>
                                    <th (click)="sort('IsCompulsory')">Compulsory</th>
                                    <th (click)="sort('IsRefundable')">Refundable</th>
                                    <th (click)="sort('Remarks')">Remarks</th>

                                </tr>
                            </thead>
                            <tbody *ngIf="action.CanEdit || action.CanCreate">
                                <tr *ngFor="let item of FeeAdmissionList; let i=index;">
                                    <td>{{i+1}}</td>
                                    <td>{{item.HeadName}}</td>
                                    <td><input [(ngModel)]="item.FeeAmount" type="text" class="form-control"></td>
                                    <td><mat-checkbox [(ngModel)]="item.IsActive" color="primary"></mat-checkbox></td>
                                    <td><mat-checkbox [(ngModel)]="item.IsCompulsory" color="primary"></mat-checkbox></td>
                                    <td><mat-checkbox [(ngModel)]="item.IsRefundable" color="primary"></mat-checkbox></td>
                                    <td><input [(ngModel)]="item.Remarks" type="text" class="form-control"></td>
                                </tr>
                            </tbody>
                            
                            <tbody *ngIf="!action.CanEdit && !action.CanCreate">
                                <tr *ngFor="let item of FeeAdmissionList; let i=index;">
                                    <td>{{i+1}}</td>
                                    <td>{{item.HeadName}}</td>
                                    <td>{{item.FeeAmount|money}}</td>
                                    <td>{{item.IsActive?"Yes":"No"}}</td>
                                    <td>{{item.IsCompulsory?"Yes":"No"}}</td>
                                    <td>{{item.IsRefundable?"Yes":"No"}}</td>
                                    <td>{{item.Remarks}}</td>
                                </tr>
                            </tbody>

                        </table>
                    </div>
                </div>
            </div>
            <div class="card-footer" style="text-align: center;"
                *ngIf="FeeAdmissionList.length > 0 && (action.CanEdit || action.CanCreate)">
                <button class="btn btn-primary" (click)="saveFeeAdmission()">Submit</button>
            </div>

        </div>

    </section>

</main>